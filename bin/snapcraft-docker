#!/usr/bin/env bash
# ----------------------------------------------------------------------------
# Description: Small wrapper script to make building snaps with docker a 
#   `snap`!
# Author: Urs Roesch
# ----------------------------------------------------------------------------

# ----------------------------------------------------------------------------
# Setup
# ----------------------------------------------------------------------------
set -o errexit
set -o nounset
set -o pipefail

# ----------------------------------------------------------------------------
# Globals
# ----------------------------------------------------------------------------
declare -r DOCKER_USER=build
declare -r DOCKER_CONTAINER=snapcore/snapcraft:custom

# ----------------------------------------------------------------------------
# Main
# ----------------------------------------------------------------------------
sudo docker run \
  -u ${DOCKER_USER} \
  -v "${HOME}":/home/build \
  -v "${PWD}":/build \
  -w /build \
  ${DOCKER_CONTAINER} \
  snapcraft "$@"
